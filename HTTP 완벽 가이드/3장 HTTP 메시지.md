## 3.1 메시지의 흐름

1. 메시지는 원 서버 방향을 인바운드로 하여 송신된다.
    - 인바운드 (서버 방향)
    - 아웃바운드 (클라이언트 방향)
2. 모든 메시지는 다운스트림으로 흐른다.
    - 클라이언트가 요청을 보낼 때는 업스트림이고 받을 때는 다운스트림이 된다.

## 3.2 메시지의 각 부분

- 메시지는 시작줄, 헤더 블록, 본문으로 이루어져 있다.

### 메시지 문법

요청 메시지
```
<메서드> <요청 URL> <버전>

<헤더>

<엔터티 본문>
```
응답 메시지
```
<버전> <상태코드> <사유 구절>

<헤더>

<엔터티 본문>
```
### 시작줄

- 요청 메시지: 무엇을 해야 하는지
- 응답 메시지: 무슨 일이 일어났는 지

메서드

- `GET` `POST` `HEAD` `PUT` `TRACE` `OPTIONS` `DELETE`

상태 코드

| 전체 범위 | 정의 된 범위 | 분류 |
| --- | --- | --- |
| 100-199 | 100-101 | 정보 |
| 200-299 | 200-206 | 성공 |
| 300-399 | 300-305 | 리다이렉션 |
| 400-499 | 400-415 | 클라이언트 에러 |
| 500-599 | 500-505 | 서버 에러 |

사유 구절

- 상태 코드에 대한 글로 된 설명
- 오직 사람이 읽기 위해 존재

버전 번호

- `HTTP/x.y` 형식으로 기술
- 어플리케이션이 지원하는 가장 높은 HTTP 버전을 가리킴
    - `HTTP/1.1`로 된 응답이라면 `HTTP/1.1` 메시지가 아닌 `HTTP/1.1` 까지 이해할 수 있다는 것을 의미함

### 헤더

- 일반 헤더, 요청 헤더, 응답 헤더, 엔터티 헤더, 확장 헤더로 분류
- 0개 이상의 헤더 존재
- `:`으로 나누어진 이름/값 쌍의 목록
    - ex) `Content-length:19`
    

### 엔터티 본문

- HTTP 메시지의 화물
    - 이미지, 비디오, HTML 문서 등..

## 3.3 메서드

### 안전한 메서드

- HTTP 요청을 보냈을 때 서버에 어떤 작용도 하지 않는 메서드
    - `GET` `HEAD` 등
- 서버에 영향을 줄 수 있는 메서드가 사용 될 때 사용자에게 그 사실을 알려주는 HTTP 어플리케이션을 만들 수 있도록 하는 목적이 있다.
    
    → ‘안전하지 않은 메서드’를 사용하게 되면 리소스의 상태가 변경되는데, ‘안전한 메서드’를 사용해서 변경된 리소스를 확인 할 수 있다는 뜻… 아닐까 싶다
    

### 메서드 종류

- `GET`: 서버에게 리소스를 달라고 요청
- `HEAD`: `GET` 과 같이 행동하지만, 엔터티 본문이 봔환되지 않음
    - 리소스를 가져오지 않고 리소스가 무엇인지 알아낼 수 있음
    - 상태 코드를 통해 개체가 존재하는지 확인
    - 헤더를 확인하여 리소스가 변경되었는지 검사
    - 반환되는 헤더가 `GET` 과 정확히 일치해야 한다.
- `PUT` : 요청 URL대로 새로 문서를 만들거나, 존재한다면 교체함
- `POST` : 서버에 입력 데이터를 전송
- `TRACE` : 클라이언트에게 자신의 요청이 서버에 도달했을 때 어떻게 보이는지 알려줌
    - 주로 진단을 위해 사용
- `OPTIONS` : 특정 리소스에 어떤 메서드가 지원되는지 물어봄
- `DELETE` : 서버에게 요청 URL의 리소스 삭제 요청

## 3.4 상태 코드

너무 많아서 자주 보이는 것만 정리..

1. 100-199: 정보성 상태 코드
    - 100 Continue: 요청 일부가 받아들여졌으며, 나머지를 계속 보내라는 뜻
2. 200-299: 성공 상태 코드
    - 200 OK: 요청이 정상이며 본문에 요청된 리소스가 있음
    - 201 Created: 서버 객체를 생성하라는 요청에 대한 응답
        - 생성된 리소스에 대한 Location 헤더와 리소스를 참조할 수 있는 URL을 본문에 포함해야 함
    - 202 Accepted: 요청이 받아졌지만 서버가 그에 대한 동작을 수행하지 않음
    - 204 No Content: 엔터티 본문을 포함하지 않음
        - 웹브라우저를 갱신하고자 할 때 사용
3. 300-399: 리다이렉션 상태 코드
    - 301 Moved Permanently: 요청한 URL이 옮겨졌을 때
        - Location 헤더에 현재 리소스가 존재하는 URL을 포함해서 보내줘야 함
    - 304 Not Modified: 조건부 요청을 보냈는데 수정 된 일이 없는 경우
4. 400-499: 클라이언트 에러 상태 코드
    - 400 Bad Request: 클라이언트가 잘못된 요청을 보냄
    - 401 Unauthorized: 인증이 필요함
    - 403 Forbidden: 요청이 서버에 거부되었음
    - 404 Not Found: 서버가 요청한 URL을 찾을 수 없음
    - 405 Method Not Allowed: 요청한 URL에 대해 지원하지 않는 메서드로 요청 받았을 때
        - 요청에 Allow 헤더가 포함되어야 함 (응답 아닌가..?)
    
5. 500-599: 서버 에러 상태 코드
    - 500: Internal Server Error: 서버가 요청을 처리할 수 없을 때
    - 502 Bad Gateway: 프록시나 게이트웨이처럼 행동하는 서버가 가짜 응답을 맞닥뜨렸을 때
        - ex) 자신의 부모 게이트웨이에 접속하는 것이 불가능
    - 503 Service Unavailable: 현재 서버가 요청을 처리해줄 수 없지만 나중에는 가능함을 의미

## 3.5 헤더

### 일반 헤더

- 서버, 클라이언트 모두 사용
- `Connection` , `Date` 등

### 요청 헤더

- 서버에게 클라이언트가 받고자 하는 데이터 타입이 무엇인지와 같은 부가 정보 요청
- Accept 관련 요청 헤더
    - ex) `Accept: */*` → 모든 미디어 타입 허용
- 조건부 요청 헤더
    - ex) 클라이언트가 사본을 가지고 있다면 그 사본이 변경되었을 때만 전송해달라고 제한할 수 있음
    - `If-Modified-Since` → 주어진 날짜 이후에 리소스가 변경되었다면 요청을 제한함
- 요청 보안 헤더
    - `Authorization` : 서버에게 제공하는 인증 자체에 대한 정보
    

### 응답 헤더

- 클라이언트에게 정보를 제공하기 위한 헤더
    - ex) `Server`: 어떤 종류의 서버와 대화하는지
- 협상 헤더: 여러 표현이 가능할 때 어떤 것을 선택할 것인가?
- 응답 보안 헤더

### 엔터티 헤더

- `Allow` 수행될 수 있는 요청 메서드 나열
- `Location` 엔터티가 어디에 위치해있는지
- 콘텐츠 헤더
    - `Content-Type` , `Content-Length` 등
- 엔터티 캐싱 헤더
